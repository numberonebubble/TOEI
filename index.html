<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Odd Earth Institute</title>
    <style>
        /* --- CORE STYLES --- */
        :root {
            --bg: #050a10;
            --blue: #4a90e2;
            --green: #00ff88;
            --gold: #ffcc00;
            --purple: #bf00ff;
            --alert: #ff3333;
            --dim: #445566;
            --panel-bg: rgba(5, 10, 16, 0.9);
        }

        body, html {
            margin: 0;
            padding: 0;
            background-color: var(--bg);
            color: #eee;
            font-family: 'Courier New', Courier, monospace;
            width: 100%;
            height: 100%;
            overflow-x: hidden;
        }

        /* --- UI ELEMENTS --- */
        
        /* Navigation / HUD */
        .hud-bar {
            position: fixed;
            top: 0; left: 0; width: 100%;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            z-index: 100;
            pointer-events: none; /* Let clicks pass through to canvas */
        }
        
        .logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 2px;
            pointer-events: auto;
            cursor: pointer;
            border: 1px solid transparent;
            padding: 5px 10px;
            transition: 0.3s;
        }
        .logo:hover { border-color: var(--gold); background: rgba(255, 204, 0, 0.1); }

        .status {
            text-align: right;
            font-size: 0.8rem;
            color: var(--blue);
        }

        /* Back Button (Hidden on Home) */
        #back-btn {
            position: fixed;
            bottom: 30px; left: 50%;
            transform: translateX(-50%);
            padding: 10px 30px;
            background: var(--bg);
            border: 1px solid var(--dim);
            color: var(--dim);
            text-transform: uppercase;
            cursor: pointer;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: 0.3s;
            letter-spacing: 2px;
        }
        #back-btn.active {
            opacity: 1;
            pointer-events: auto;
        }
        #back-btn:hover { color: var(--gold); border-color: var(--gold); }

        /* --- 3D CANVAS --- */
        #canvas-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }
        
        .scanlines {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
                        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 2;
        }

        /* --- CONTENT CONTAINERS --- */
        
        /* 1. HOME CONTAINER */
        #home-container {
            position: relative;
            z-index: 10;
            transition: opacity 0.5s;
        }

        section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            box-sizing: border-box;
        }

        /* Text Cards */
        .card {
            background: var(--panel-bg);
            border: 1px solid var(--dim);
            padding: 3rem;
            max-width: 700px;
            width: 100%;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
        }
        
        .card.manifesto { border-top: 4px solid var(--gold); text-align: center; }
        .card.rebellion { border-left: 4px solid var(--alert); }
        .card.method { border-right: 4px solid var(--blue); text-align: right; }

        h1 { font-size: 3rem; margin: 0 0 1rem; color: #fff; text-transform: uppercase; line-height: 1; }
        h2 { font-size: 2rem; margin: 0 0 1rem; color: var(--blue); text-transform: uppercase; }
        p { font-size: 1.1rem; line-height: 1.6; color: #aaa; margin-bottom: 1rem; }
        .highlight { color: #fff; font-weight: bold; }

        /* Project Grid (Bottom of Home) */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1000px;
        }

        .grid-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--dim);
            padding: 20px;
            cursor: pointer;
            transition: 0.3s;
            text-align: left;
        }
        .grid-item:hover {
            background: rgba(255,255,255,0.1);
            border-color: var(--green);
            transform: translateY(-5px);
        }
        .grid-item h3 { margin: 0 0 5px; color: var(--green); font-size: 0.9rem; text-transform: uppercase; }
        .grid-item span { color: #888; font-size: 0.8rem; }

        /* 2. PROJECT DETAIL CONTAINER (Initially Hidden) */
        #project-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 20;
            pointer-events: none; /* Allow click through when hidden */
            opacity: 0;
            transition: opacity 0.5s;
            display: flex;
            align-items: center;
            justify-content: flex-start; /* Align text to side */
            padding: 5% 10%;
            box-sizing: border-box;
            background: rgba(5, 10, 16, 0.4); /* Slight tint */
        }
        
        #project-container.active {
            opacity: 1;
            pointer-events: auto;
        }

        .project-card {
            background: var(--panel-bg);
            border: 1px solid var(--green);
            padding: 40px;
            max-width: 500px;
            transform: translateX(-50px);
            transition: transform 0.5s ease-out;
        }
        
        #project-container.active .project-card {
            transform: translateX(0);
        }

        .project-label { color: var(--green); font-size: 0.8rem; letter-spacing: 2px; text-transform: uppercase; display: block; margin-bottom: 15px; }
        .project-title { color: #fff; font-size: 2.5rem; text-transform: uppercase; margin: 0 0 20px; line-height: 1; }
        .project-body { color: #ccc; font-size: 1rem; line-height: 1.6; }
        
        .stat-box {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px dashed var(--dim);
            display: flex;
            justify-content: space-between;
        }
        .stat { text-align: center; }
        .stat .val { display: block; color: var(--blue); font-size: 1.5rem; font-weight: bold; }
        .stat .lbl { display: block; color: #666; font-size: 0.7rem; text-transform: uppercase; }

    </style>
</head>
<body>

    <div class="hud-bar">
        <div class="logo" onclick="goHome()">ODD EARTH INSTITUTE</div>
        <div class="status">
            LATERAL THINKING<br>
            WITHERED TECH
        </div>
    </div>

    <div id="canvas-container"></div>
    <div class="scanlines"></div>

    <div id="home-container">
        
        <section>
            <div class="card manifesto">
                <h2>The Odd Earth Institute</h2>
                <p>We are a think tank for the left-behind.</p>
                <p>We use lateral thinking with withered technologies to solve real-world problems for real people.</p>
                <br>
                <span style="font-size: 0.8rem; color: var(--gold);">SCROLL TO EXPLORE</span>
            </div>
        </section>

        <section>
            <div class="card rebellion">
                <h2>Profit & Policy Have Failed</h2>
                <p>Governments are slow. The Private Sector is greedy. They have failed to move the needle on the things that actually matter.</p>
                <p>We act as a force for good with no regard for bureaucracy. We don't ask for permission. We just build solutions that work.</p>
            </div>
        </section>

        <section>
            <div class="card method">
                <h2>The Garage Method</h2>
                <p>We don't need million-dollar labs. We need a garage, a soldering iron, and a fresh perspective.</p>
                <p>Inspired by <strong>Gunpei Yokoi</strong>, we repurpose mature, cheap technology to do things they were never designed to do.</p>
            </div>
        </section>

        <section style="flex-direction: column;">
            <h2 style="color: #fff; margin-bottom: 30px;">Active Initiatives</h2>
            <div class="grid-container">
                <div class="grid-item" onclick="openProject(0)">
                    <h3>The Medical Paradox</h3>
                    <span>CT Scanners vs. Access</span>
                </div>
                <div class="grid-item" onclick="openProject(1)">
                    <h3>Trauma Response</h3>
                    <span>First Responders vs. Tech</span>
                </div>
                <div class="grid-item" onclick="openProject(2)">
                    <h3>Forensics</h3>
                    <span>The 8% Conviction Rate</span>
                </div>
                <div class="grid-item" onclick="openProject(3)">
                    <h3>Genomics</h3>
                    <span>$1000 Tests vs. Physics</span>
                </div>
                <div class="grid-item" onclick="openProject(4)">
                    <h3>Diagnostics</h3>
                    <span>Invasive vs. Video Games</span>
                </div>
                <div class="grid-item" onclick="openProject(5)">
                    <h3>The Network</h3>
                    <span>Join the Institute</span>
                </div>
            </div>
        </section>
    </div>

    <div id="project-container">
        <div class="project-card">
            <span class="project-label" id="p-label">INITIATIVE 01</span>
            <h1 class="project-title" id="p-title">Title Here</h1>
            <div class="project-body" id="p-body">
                Body text goes here.
            </div>
            <div class="stat-box" id="p-stats">
                </div>
        </div>
    </div>

    <button id="back-btn" onclick="goHome()">Return to Grid</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- DATA: PROJECT CONTENT ---
        const projects = [
            {
                // CT
                label: "THE MEDICAL PARADOX",
                title: "The Accessible Scanner",
                body: "It’s odd that we have CT scanners that can see inside brains, yet rural populations die because they live too far away. We reject big, expensive tubes. We are building localized, simplified scanning arrays using repurposed industrial sensors.",
                stats: `<div class="stat"><span class="val">90%</span><span class="lbl">Cheaper</span></div><div class="stat"><span class="val">100%</span><span class="lbl">Portable</span></div>`,
                shape: 'scanner'
            },
            {
                // Trauma
                label: "FIRST RESPONDER GAP",
                title: "Bio-Telemetry",
                body: "Trauma is the #1 killer of the working age. Responders are flying blind. We aren't building a Garmin for Golf. We are building rugged, passive bio-monitors that alert teams to stress and fatigue before mistakes happen.",
                stats: `<div class="stat"><span class="val">20%</span><span class="lbl">Deaths Preventable</span></div><div class="stat"><span class="val">24/7</span><span class="lbl">Monitoring</span></div>`,
                shape: 'watch'
            },
            {
                // Forensics
                label: "FORENSIC BLINDSPOTS",
                title: "K9 Olfactory Data",
                body: "Dogs can identify human targets with 90% accuracy. Why stick to an 8% conviction rate for violent crimes? We are digitizing and mapping K9 scent tracking to create admissible, irrefutable forensic data.",
                stats: `<div class="stat"><span class="val">90%</span><span class="lbl">Accuracy</span></div><div class="stat"><span class="val">Zero</span><span class="lbl">Lab Time</span></div>`,
                shape: 'dog'
            },
            {
                // Genomics
                label: "PRECISION MEDICINE",
                title: "Optical Sequencing",
                body: "We abandoned Feynman’s idea of looking at DNA with microscopes. We're bringing it back. By using physics instead of chemistry, we drop the cost of cancer screening from $1000 to $50, with results in one hour.",
                stats: `<div class="stat"><span class="val">$50</span><span class="lbl">Cost</span></div><div class="stat"><span class="val">1 Hr</span><span class="lbl">Time</span></div>`,
                shape: 'helix'
            },
            {
                // Diagnostics
                label: "LATERAL DIAGNOSTICS",
                title: "The Game Controller",
                body: "Why bleed into a test tube? We use modified game controllers to measure micro-tremors and reaction times, diagnosing neurological conditions through gameplay. Non-invasive, fun, and accurate.",
                stats: `<div class="stat"><span class="val">0</span><span class="lbl">Needles</span></div><div class="stat"><span class="val">High</span><span class="lbl">Engagement</span></div>`,
                shape: 'controller'
            },
            {
                // Network
                label: "THE ASK",
                title: "Infinite Potential",
                body: "The world deserves odd solutions. Every piece of old tech holds a new answer. We have the questions. We need the resources. Join us as a donor or an engineer.",
                stats: `<div class="stat"><span class="val">∞</span><span class="lbl">Possibilities</span></div>`,
                shape: 'earth' // Or Potential
            }
        ];

        // --- 3D ENGINE SETUP ---
        const PARTICLE_COUNT = 18000;
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x050a10);
        scene.fog = new THREE.Fog(0x050a10, 15, 60);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.z = 25;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // --- SHAPE GENERATORS ---
        const rand = (min, max) => Math.random() * (max - min) + min;
        const createShapeData = () => ({ positions: [], colors: [] });
        
        const shapes = {
            chaos: createShapeData(),     // Intro
            globe: createShapeData(),     // Institute/Home
            barrier: createShapeData(),   // "Rebellion" (Wall)
            workshop: createShapeData(),  // "Method" (Gameboy/Tech)
            
            // Projects
            scanner: createShapeData(),
            watch: createShapeData(),
            dog: createShapeData(),
            helix: createShapeData(),
            controller: createShapeData(),
            earth: createShapeData()      // Network/End
        };

        // 1. CHAOS
        for(let i=0; i<PARTICLE_COUNT; i++) {
            shapes.chaos.positions.push(rand(-30,30), rand(-30,30), rand(-20,20));
            shapes.chaos.colors.push(0.2, 0.2, 0.3);
        }

        // 2. GLOBE (Odd Earth Logo)
        for(let i=0; i<PARTICLE_COUNT; i++) {
            const u = Math.random(); const v = Math.random();
            const theta = 2 * Math.PI * u; const phi = Math.acos(2 * v - 1);
            const r = 9;
            shapes.globe.positions.push(r*Math.sin(phi)*Math.cos(theta), r*Math.sin(phi)*Math.sin(theta), r*Math.cos(phi));
            shapes.globe.colors.push(1, 0.8, 0); // Gold Globe
        }

        // 3. BARRIER (Grid Wall)
        for(let i=0; i<PARTICLE_COUNT; i++) {
            shapes.barrier.positions.push(rand(-15,15), rand(-10,10), rand(-1,1)); // Flat wall
            if(Math.random()>0.9) shapes.barrier.colors.push(1, 0.2, 0.2); // Red Glitch
            else shapes.barrier.colors.push(0.4, 0.4, 0.5); // Grey Wall
        }

        // 4. WORKSHOP (Gameboy/Tech shape)
        for(let i=0; i<PARTICLE_COUNT; i++) {
             const x = rand(-5, 5); const y = rand(-7, 7); const z = rand(-2, 2);
             shapes.workshop.positions.push(x, y, z);
             // Screen
             if(Math.abs(x)<4 && y>1 && y<5) shapes.workshop.colors.push(0, 1, 0.5); 
             else shapes.workshop.colors.push(0.3, 0.3, 0.4);
        }

        // 5. SCANNER (CT)
        for(let i=0; i<PARTICLE_COUNT; i++) {
            if(i < PARTICLE_COUNT*0.7) {
                const a = rand(0, Math.PI*2); const r = rand(9,11);
                shapes.scanner.positions.push(Math.cos(a)*r, Math.sin(a)*r, rand(-4,4));
                shapes.scanner.colors.push(0.2, 0.6, 1);
            } else {
                shapes.scanner.positions.push(rand(-3,3), rand(-3,-2), rand(-10,10));
                shapes.scanner.colors.push(1,1,1);
            }
        }

        // 6. WATCH
        for(let i=0; i<PARTICLE_COUNT; i++) {
             const r = Math.random();
             if(r<0.4) { // Strap
                const a = rand(0, Math.PI*2); 
                if(Math.abs(a)>0.6) {
                    shapes.watch.positions.push(Math.sin(a)*7, Math.cos(a)*7, rand(-2,2));
                    shapes.watch.colors.push(0.2,0.2,0.2);
                } else { shapes.watch.positions.push(0,0,0); shapes.watch.colors.push(0,0,0); }
             } else { // Face + Pulse
                 const x = rand(-3,3); let z=0;
                 if(Math.abs(x)<1) z = Math.sin(x*10); // Pulse
                 shapes.watch.positions.push(x, 7, z);
                 if(Math.abs(z)>0.1) shapes.watch.colors.push(1,0,0.2); else shapes.watch.colors.push(0,0,0);
             }
        }

        // 7. DOG
        for(let i=0; i<PARTICLE_COUNT; i++) {
            const r = Math.random();
            let x,y,z; let c=[0.6, 0.4, 0.2];
            if(r<0.5) { x=rand(-4,4); y=rand(-2,2); z=rand(-1.5,1.5); } // Body
            else if(r<0.7) { x=rand(4,6); y=rand(1,3.5); z=rand(-1,1); } // Head
            else if(r<0.9) { x=(rand(-1,1)>0?3:-3); y=rand(-6,-2); z=rand(-1,1); } // Legs
            else { x=rand(-6,-4); y=rand(0,2); z=0; } // Tail
            shapes.dog.positions.push(x,y,z); shapes.dog.colors.push(...c);
        }

        // 8. HELIX
        for(let i=0; i<PARTICLE_COUNT; i++) {
            const t = rand(-10,10); const s = Math.random()>0.5?0:Math.PI;
            if(Math.random()>0.3) {
                shapes.helix.positions.push(Math.cos(t*1.5+s)*5, t*1.5, Math.sin(t*1.5+s)*5);
                shapes.helix.colors.push(0.6,0,0.8);
            } else {
                shapes.helix.positions.push(Math.cos(t*1.5)*rand(-5,5), t*1.5, Math.sin(t*1.5)*rand(-5,5));
                shapes.helix.colors.push(0,0.8,0.8);
            }
        }

        // 9. CONTROLLER
        for(let i=0; i<PARTICLE_COUNT; i++) {
             const r = Math.random();
             if(r<0.4) shapes.controller.positions.push(rand(-7,-3), rand(-2,2), rand(-2,2)); // L
             else if(r<0.8) shapes.controller.positions.push(rand(3,7), rand(-2,2), rand(-2,2)); // R
             else shapes.controller.positions.push(rand(-3,3), rand(-1,1), rand(-1,1)); // Center
             shapes.controller.colors.push(0.8,0.8,0.8);
        }

        // 10. EARTH (End)
        for(let i=0; i<PARTICLE_COUNT; i++) {
            const u=Math.random(); const v=Math.random();
            const r=8; const t=2*Math.PI*u; const p=Math.acos(2*v-1);
            shapes.earth.positions.push(r*Math.sin(p)*Math.cos(t), r*Math.sin(p)*Math.sin(t), r*Math.cos(p));
            if(Math.random()>0.7) shapes.earth.colors.push(0,1,0.5); else shapes.earth.colors.push(0,0.1,0.3);
        }


        // --- PARTICLE MESH ---
        const geometry = new THREE.BufferGeometry();
        const posArr = new Float32Array(PARTICLE_COUNT*3);
        const colArr = new Float32Array(PARTICLE_COUNT*3);
        
        // Init with Chaos
        for(let i=0; i<PARTICLE_COUNT*3; i++) {
            posArr[i] = shapes.chaos.positions[i];
            colArr[i] = shapes.chaos.colors[i];
        }
        
        geometry.setAttribute('position', new THREE.BufferAttribute(posArr, 3));
        geometry.setAttribute('color', new THREE.BufferAttribute(colArr, 3));
        
        const material = new THREE.PointsMaterial({
            size: 0.15, vertexColors: true, transparent: true, opacity: 0.9, blending: THREE.AdditiveBlending
        });
        const points = new THREE.Points(geometry, material);
        scene.add(points);


        // --- STATE MANAGEMENT ---
        let currentPosTarget = shapes.chaos.positions;
        let currentColTarget = shapes.chaos.colors;
        let appState = 'home'; // 'home' or 'project'
        let currentShapeName = 'chaos';

        // --- NAVIGATION LOGIC ---
        
        const homeContainer = document.getElementById('home-container');
        const projectContainer = document.getElementById('project-container');
        const backBtn = document.getElementById('back-btn');

        // Scroll listener for HOME ONLY
        window.addEventListener('scroll', () => {
            if(appState !== 'home') return;
            
            const scrollY = window.scrollY;
            const h = window.innerHeight;
            const idx = Math.round(scrollY / h);
            
            // Map home sections to shapes
            // 0: Chaos/Intro, 1: Globe/Manifesto, 2: Barrier/Rebellion, 3: Workshop/Method, 4: Grid/Scanner
            let targetKey = 'chaos';
            if(idx === 0) targetKey = 'globe';
            if(idx === 1) targetKey = 'barrier';
            if(idx === 2) targetKey = 'workshop';
            if(idx >= 3) targetKey = 'earth';

            currentShapeName = targetKey;
            currentPosTarget = shapes[targetKey].positions;
            currentColTarget = shapes[targetKey].colors;
        });

        function openProject(index) {
            appState = 'project';
            const p = projects[index];
            
            // 1. Update UI Text
            document.getElementById('p-label').innerText = p.label;
            document.getElementById('p-title').innerText = p.title;
            document.getElementById('p-body').innerText = p.body;
            document.getElementById('p-stats').innerHTML = p.stats;

            // 2. Transition Views
            homeContainer.style.opacity = 0;
            setTimeout(() => {
                homeContainer.style.display = 'none';
                window.scrollTo(0,0); // Reset scroll
                projectContainer.classList.add('active');
                backBtn.classList.add('active');
            }, 500);

            // 3. Update 3D Shape
            const targetKey = p.shape;
            currentPosTarget = shapes[targetKey].positions;
            currentColTarget = shapes[targetKey].colors;
            
            // Move camera for side view (text is on left)
            // We'll handle this in the render loop via targetOffset
        }

        function goHome() {
            appState = 'home';
            
            // 1. Transition Views
            projectContainer.classList.remove('active');
            backBtn.classList.remove('active');
            
            setTimeout(() => {
                homeContainer.style.display = 'block';
                setTimeout(() => homeContainer.style.opacity = 1, 50);
            }, 500);

            // 2. Reset 3D
            currentPosTarget = shapes.globe.positions;
            currentColTarget = shapes.globe.colors;
        }


        // --- ANIMATION LOOP ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();
            
            const p = geometry.attributes.position.array;
            const c = geometry.attributes.color.array;
            const speed = 0.05;

            // Offset logic: When in project mode, shift object right to make room for text
            const xOffset = (appState === 'project') ? 7 : 0;

            for(let i=0; i<PARTICLE_COUNT; i++) {
                const ix = i*3; const iy = i*3+1; const iz = i*3+2;
                
                // Target X position needs offset applied
                const tx = currentPosTarget[ix] + xOffset;
                const ty = currentPosTarget[iy];
                const tz = currentPosTarget[iz];

                p[ix] += (tx - p[ix]) * speed;
                p[iy] += (ty - p[iy]) * speed;
                p[iz] += (tz - p[iz]) * speed;

                c[ix] += (currentColTarget[ix] - c[ix]) * speed;
                c[iy] += (currentColTarget[iy] - c[iy]) * speed;
                c[iz] += (currentColTarget[iz] - c[iz]) * speed;
                
                // Noise
                p[ix] += Math.sin(time + p[iy]) * 0.003;
            }

            geometry.attributes.position.needsUpdate = true;
            geometry.attributes.color.needsUpdate = true;
            
            // Scene Rotation
            if(appState === 'home') {
                points.rotation.y += 0.001;
            } else {
                points.rotation.y = Math.sin(time * 0.2) * 0.1; // Gentle sway in project mode
            }

            renderer.render(scene, camera);
        }

        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>
</html>
